//
//  CTView.swift
//  CoreTextTutorial
//
//  Created by Bathant on 15/12/2020.
//
import Foundation
import UIKit
class CTView: UIView{
    override func draw(_ rect: CGRect) {
        guard let context = UIGraphicsGetCurrentContext() else { return }
        // 3
        // Flip the coordinate system
        context.textMatrix = .identity
        context.translateBy(x: 0, y: bounds.size.height)
        context.scaleBy(x: 1.0, y: -1.0)
        let path = CGMutablePath()
        path.addRect(bounds)
        // 4
        let text = "في ردود الفعل التي شجبت عمليات التطبيع العربية الأخيرة مع إسرائيل، ثمة شيء غائب في المكتوب، ولو كان حاضراً في المحكي: إنه الحاجات الحيوية لدى هذه الدول التي تطبع. قليلون جداً من استوقفهم أن لدى هذه الدول وشعوبها، هي الأخرى، قضاياها.خطر إيران وميلها التوسعي، واستعادة المغرب ما يعتبره وحدته الترابية، ورفع اسم السودان من قائمة الإرهاب وما ينجر اقتصادياً عن ذلك، ليست عناوين بسيطة. حتى لبنان الذي لم يطبع، وجد من يفسر مفاوضاته المباشرة مع الإسرائيليين حول ترسيم الحدود بحاجته إلى استخراج نفطه. وما دام أن «العرب» دول ومجتمعات ومصالح، سيكون صعباً تجاهل تلك المسائل والهموم، أو اختصارها في رغبة هذه الفئة الحاكمة أو تلك، أو مطالبة أصحابها بالتضحية بها وفاءً بـ«التزام قومي» لم يعد يعني الكثير لأحد. هناك بين مناهضي التطبيع من قال إنه يسهل قمع الأنظمة للشعوب. لكنْ ماذا يقال، والحال هذه، حين تكون أشد الأنظمة قمعاً لشعوبها، وفتكاً بالفلسطينيين أنفسهم، هي الأكثر تشدقاً بمقاتلة إسرائيل ومحاربة التطبيع؟ إذن الحجة هذه حمالة أوجه، والمسألة قابلة للاشتغال في اتجاهات شتى بتطبيع أو من دونه.  المرارة الفلسطينية مفهومة تماماً، خصوصاً أن الاستيطان وقضم الأراضي وانكماش خيار الدولتين تمضي في خنق الحق الذي لا يُمارى فيه. يزيد في المرارة ويمزجها بالخديعة تاريخ من الشعارات العربية التي تعددت عناوينها: «قضية العرب الأولى». «قضية العرب المركزية». «البوصلة». «موقفنا من دول العالم يُبنى على موقفها من قضية فلسطين»... مَن كانوا يسمعون هذا الكلام الكثير والمتكرر انقسموا بين مُصدقين له ومتظاهرين بالتصديق تبعاً لضعف ذات اليد.  مع ذلك، وما دمنا نتحدث عن دول وسياسات، وأحياناً سياسات متضاربة، فإن القضية الفلسطينية ما عادت تتقاطع مع الهموم الوطنية لباقي الدول العربية. ما عادت تحمل وعداً تحررياً لأحد. ما عادت تحمل وعداً اقتصادياً بحياة أفضل. الدعوات التي تظهر على هامش القضية إلى مقاومات ومواجهات بلا نهاية فقدت كل جاذبية في العالم العربي، وأغلب الظن بين الفلسطينيين أنفسهم. هذا الانقطاع بين القضية وشؤون الدول وهمومها بات الخلاصة الكارثية على الجميع، الخلاصة التي لم تكن السياسات الفلسطينية بريئة منها. فالقضية لم تعد تخاطب مصالح الدول والشعوب أو مخاوفها، لا بل هي تغذي تلك المخاوف أحياناً. فلنفكر للحظة في أن حركات كـ«حماس» أو «الجهاد الإسلامي» تتحالف مع إيران التي يشعر شطر أساسي من العالم العربي بالخوف منها. إنهما تكرران على نحو أسوأ وقوف منظمة التحرير الفلسطينية مع صدام حسين حين غزا الكويت عام 1990. المحكي: إنه الحاجات الحيوية لدى هذه الدول التي تطبع. قليلون جداً من استوقفهم أن لدى هذه الدول وشعوبها، هي الأخرى، قضاياها.خطر إيران وميلها التوسعي، واستعادة المغرب ما يعتبره وحدته الترابية، ورفع اسم السودان من قائمة الإرهاب وما ينجر اقتصادياً عن ذلك، ليست عناوين بسيطة. حتى لبنان الذي لم يطبع، وجد من يفسر مفاوضاته المباشرة مع الإسرائيليين حول ترسيم الحدود بحاجته إلى استخراج نفطه. وما دام أن «العرب» دول ومجتمعات ومصالح، سيكون صعباً تجاهل تلك المسائل والهموم، أو اختصارها في رغبة هذه الفئة الحاكمة أو تلك، أو مطالبة أصحابها بالتضحية بها وفاءً بـ«التزام قومي» لم يعد يعني الكثير لأحد. هناك بين مناهضي التطبيع من قال إنه يسهل قمع الأنظمة للشعوب. لكنْ ماذا يقال، والحال هذه، حين تكون أشد الأنظمة قمعاً لشعوبها، وفتكاً بالفلسطينيين أنفسهم، هي الأكثر تشدقاً بمقاتلة إسرائيل ومحاربة التطبيع؟ إذن الحجة هذه حمالة أوجه، والمسألة قابلة للاشتغال في اتجاهات شتى بتطبيع أو من دونه.  المرارة الفلسطينية مفهومة تماماً، خصوصاً أن الاستيطان وقضم الأراضي وانكماش خيار الدولتين تمضي في خنق الحق الذي لا يُمارى فيه. يزيد في المرارة ويمزجها بالخديعة تاريخ من الشعارات العربية التي تعددت عناوينها: «قضية العرب الأولى». «قضية العرب المركزية». «البوصلة». «موقفنا من دول العالم يُبنى على موقفها من قضية فلسطين»... مَن كانوا يسمعون هذا الكلام الكثير والمتكرر انقسموا بين مُصدقين له ومتظاهرين بالتصديق تبعاً لضعف ذات اليد.  مع ذلك، وما دمنا نتحدث عن دول وسياسات، وأحياناً سياسات متضاربة، فإن القضية الفلسطينية ما عادت تتقاطع مع الهموم الوطنية لباقي الدول العربية. ما عادت تحمل وعداً تحررياً لأحد. ما عادت تحمل وعداً اقتصادياً بحياة أفضل. الدعوات التي تظهر على هامش القضية إلى مقاومات ومواجهات بلا نهاية فقدت كل جاذبية في العالم العربي، وأغلب الظن بين الفلسطينيين أنفسهم. هذا الانقطاع بين القضية وشؤون الدول وهمومها بات الخلاصة الكارثية على الجميع، الخلاصة التي لم تكن السياسات الفلسطينية بريئة منها. فالقضية لم تعد تخاطب مصالح الدول والشعوب أو مخاوفها، لا بل هي تغذي تلك المخاوف أحياناً. فلنفكر للحظة في أن حركات كـ«حماس» أو «الجهاد الإسلامي» تتحالف مع إيران التي يشعر شطر أساسي من العالم ا المحكي: إنه الحاجات الحيوية لدى هذه الدول التي تطبع. قليلون جداً من استوقفهم أن لدى هذه الدول وشعوبها، هي الأخرى، قضاياها.خطر إيران وميلها التوسعي، واستعادة المغرب ما يعتبره وحدته الترابية، ورفع اسم السودان من قائمة الإرهاب وما ينجر اقتصادياً عن ذلك، ليست عناوين بسيطة. حتى لبنان الذي لم يطبع، وجد من يفسر مفاوضاته المباشرة مع الإسرائيليين حول ترسيم الحدود بحاجته إلى استخراج نفطه. وما دام أن «العرب» دول ومجتمعات ومصالح، سيكون صعباً تجاهل تلك المسائل والهموم، أو اختصارها في رغبة هذه الفئة الحاكمة أو تلك، أو مطالبة أصحابها بالتضحية بها وفاءً بـ«التزام قومي» لم يعد يعني الكثير لأحد. هناك بين مناهضي التطبيع من قال إنه يسهل قمع الأنظمة للشعوب. لكنْ ماذا يقال، والحال هذه، حين تكون أشد الأنظمة قمعاً لشعوبها، وفتكاً بالفلسطينيين أنفسهم، هي الأكثر تشدقاً بمقاتلة إسرائيل ومحاربة التطبيع؟ إذن الحجة هذه حمالة أوجه، والمسألة قابلة للاشتغال في اتجاهات شتى بتطبيع أو من دونه.  المرارة الفلسطينية مفهومة تماماً، خصوصاً أن الاستيطان وقضم الأراضي وانكماش خيار الدولتين تمضي في خنق الحق الذي لا يُمارى فيه. يزيد في المرارة ويمزجها بالخديعة تاريخ من الشعارات العربية التي تعددت عناوينها: «قضية العرب الأولى». «قضية العرب المركزية». «البوصلة». «موقفنا من دول العالم يُبنى على موقفها من قضية فلسطين»... مَن كانوا يسمعون هذا الكلام الكثير والمتكرر انقسموا بين مُصدقين له ومتظاهرين بالتصديق تبعاً لضعف ذات اليد.  مع ذلك، وما دمنا نتحدث عن دول وسياسات، وأحياناً سياسات متضاربة، فإن القضية الفلسطينية ما عادت تتقاطع مع الهموم الوطنية لباقي الدول العربية. ما عادت تحمل وعداً تحررياً لأحد. ما عادت تحمل وعداً اقتصادياً بحياة أفضل. الدعوات التي تظهر على هامش القضية إلى مقاومات ومواجهات بلا نهاية فقدت كل جاذبية في العالم العربي، وأغلب الظن بين الفلسطينيين أنفسهم. هذا الانقطاع بين القضية وشؤون الدول وهمومها بات الخلاصة الكارثية على الجميع، الخلاصة التي لم تكن السياسات الفلسطينية بريئة منها. فالقضية لم تعد تخاطب مصالح الدول والشعوب أو مخاوفها، لا بل هي تغذي تلك المخاوف أحياناً. فلنفكر للحظة في أن حركات كـ«حماس» أو «الجهاد الإسلامي» تتحالف مع إيران التي يشعر شطر أساسي من العالم  المحكي: إنه الحاجات الحيوية لدى هذه الدول التي تطبع. قليلون جداً من استوقفهم أن لدى هذه الدول وشعوبها، هي الأخرى، قضاياها.خطر إيران وميلها التوسعي، واستعادة المغرب ما يعتبره وحدته الترابية، ورفع اسم السودان من قائمة الإرهاب وما ينجر اقتصادياً عن ذلك، ليست عناوين بسيطة. حتى لبنان الذي لم يطبع، وجد من يفسر مفاوضاته المباشرة مع الإسرائيليين حول ترسيم الحدود بحاجته إلى استخراج نفطه. وما دام أن «العرب» دول ومجتمعات ومصالح، سيكون صعباً تجاهل تلك المسائل والهموم، أو اختصارها في رغبة هذه الفئة الحاكمة أو تلك، أو مطالبة أصحابها بالتضحية بها وفاءً بـ«التزام قومي» لم يعد يعني الكثير لأحد. هناك بين مناهضي التطبيع من قال إنه يسهل قمع الأنظمة للشعوب. لكنْ ماذا يقال، والحال هذه، حين تكون أشد الأنظمة قمعاً لشعوبها، وفتكاً بالفلسطينيين أنفسهم، هي الأكثر تشدقاً بمقاتلة إسرائيل ومحاربة التطبيع؟ إذن الحجة هذه حمالة أوجه، والمسألة قابلة للاشتغال في اتجاهات شتى بتطبيع أو من دونه.  المرارة الفلسطينية مفهومة تماماً، خصوصاً أن الاستيطان وقضم الأراضي وانكماش خيار الدولتين تمضي في خنق الحق الذي لا يُمارى فيه. يزيد في المرارة ويمزجها بالخديعة تاريخ من الشعارات العربية التي تعددت عناوينها: «قضية العرب الأولى». «قضية العرب المركزية». «البوصلة». «موقفنا من دول العالم يُبنى على موقفها من قضية فلسطين»... مَن كانوا يسمعون هذا الكلام الكثير والمتكرر انقسموا بين مُصدقين له ومتظاهرين بالتصديق تبعاً لضعف ذات اليد.  مع ذلك، وما دمنا نتحدث عن دول وسياسات، وأحياناً سياسات متضاربة، فإن القضية الفلسطينية ما عادت تتقاطع مع الهموم الوطنية لباقي الدول العربية. ما عادت تحمل وعداً تحررياً لأحد. ما عادت تحمل وعداً اقتصادياً بحياة أفضل. الدعوات التي تظهر على هامش القضية إلى مقاومات ومواجهات بلا نهاية فقدت كل جاذبية في العالم العربي، وأغلب الظن بين الفلسطينيين أنفسهم. هذا الانقطاع بين القضية وشؤون الدول وهمومها بات الخلاصة الكارثية على الجميع، الخلاصة التي لم تكن السياسات الفلسطينية بريئة منها. فالقضية لم تعد تخاطب مصالح الدول والشعوب أو مخاوفها، لا بل هي تغذي تلك المخاوف أحياناً. فلنفكر للحظة في أن حركات كـ«حماس» أو «الجهاد الإسلامي» تتحالف مع إيران التي يشعر شطر أساسي من العالم ا المحكي: إنه الحاجات الحيوية لدى هذه الدول التي تطبع. قليلون جداً من استوقفهم أن لدى هذه الدول وشعوبها، هي الأخرى، قضاياها.خطر إيران وميلها التوسعي، واستعادة المغرب ما يعتبره وحدته الترابية، ورفع اسم السودان من قائمة الإرهاب وما ينجر اقتصادياً عن ذلك، ليست عناوين بسيطة. حتى لبنان الذي لم يطبع، وجد من يفسر مفاوضاته المباشرة مع الإسرائيليين حول ترسيم الحدود بحاجته إلى استخراج نفطه. وما دام أن «العرب» دول ومجتمعات ومصالح، سيكون صعباً تجاهل تلك المسائل والهموم، أو اختصارها في رغبة هذه الفئة الحاكمة أو تلك، أو مطالبة أصحابها بالتضحية بها وفاءً بـ«التزام قومي» لم يعد يعني الكثير لأحد. هناك بين مناهضي التطبيع من قال إنه يسهل قمع الأنظمة للشعوب. لكنْ ماذا يقال، والحال هذه، حين تكون أشد الأنظمة قمعاً لشعوبها، وفتكاً بالفلسطينيين أنفسهم، هي الأكثر تشدقاً بمقاتلة إسرائيل ومحاربة التطبيع؟ إذن الحجة هذه حمالة أوجه، والمسألة قابلة للاشتغال في اتجاهات شتى بتطبيع أو من دونه.  المرارة الفلسطينية مفهومة تماماً، خصوصاً أن الاستيطان وقضم الأراضي وانكماش خيار الدولتين تمضي في خنق الحق الذي لا يُمارى فيه. يزيد في المرارة ويمزجها بالخديعة تاريخ من الشعارات العربية التي تعددت عناوينها: «قضية العرب الأولى». «قضية العرب المركزية». «البوصلة». «موقفنا من دول العالم يُبنى على موقفها من قضية فلسطين»... مَن كانوا يسمعون هذا الكلام الكثير والمتكرر انقسموا بين مُصدقين له ومتظاهرين بالتصديق تبعاً لضعف ذات اليد.  مع ذلك، وما دمنا نتحدث عن دول وسياسات، وأحياناً سياسات متضاربة، فإن القضية الفلسطينية ما عادت تتقاطع مع الهموم الوطنية لباقي الدول العربية. ما عادت تحمل وعداً تحررياً لأحد. ما عادت تحمل وعداً اقتصادياً بحياة أفضل. الدعوات التي تظهر على هامش القضية إلى مقاومات ومواجهات بلا نهاية فقدت كل جاذبية في العالم العربي، وأغلب الظن بين الفلسطينيين أنفسهم. هذا الانقطاع بين القضية وشؤون الدول وهمومها بات الخلاصة الكارثية على الجميع، الخلاصة التي لم تكن السياسات الفلسطينية بريئة منها. فالقضية لم تعد تخاطب مصالح الدول والشعوب أو مخاوفها، لا بل هي تغذي تلك المخاوف أحياناً. فلنفكر للحظة في أن حركات كـ«حماس» أو «الجهاد الإسلامي» تتحالف مع إيران التي يشعر شطر أساسي من العالم ا المحكي: إنه الحاجات الحيوية لدى هذه الدول التي تطبع. قليلون جداً من استوقفهم أن لدى هذه الدول وشعوبها، هي الأخرى، قضاياها.خطر إيران وميلها التوسعي، واستعادة المغرب ما يعتبره وحدته الترابية، "
        let attrString = NSAttributedString(string: text)
        // 5
        let framesetter = CTFramesetterCreateWithAttributedString(attrString as CFAttributedString)
        // 6
        let frame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0, attrString.length), path, nil)
        // 7
        CTFrameDraw(frame, context)
    }
}
